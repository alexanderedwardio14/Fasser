<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FASSER Networks</title>
    <link rel="stylesheet" href="styles.css">
    <script src="script.js" defer></script>
    <script type="text/javascript"
        src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js">
    </script>
    <link rel="icon" href="./image/favicon.png" type="image/x-icon">
</head>
<body>
    <header>
        <div class="top-bar">
            Whatsapp :  <a href="https://wa.me/6281322622658" style="color: white; text-decoration: none;" target="_blank">0813-2262-2658</a>, <a href="https://wa.me/6282229997768" style="color: white; text-decoration: none;" target="_blank">0822-2999-7768</a>, <a href="https://wa.me/6281280019996" style="color: white; text-decoration: none;" target="_blank">0812-8001-9996</a> Email : <a href="mailto:cs@alaskaputraperdana.com" style="color: white; text-decoration: none;">cs@alaskaputraperdana.com</a>
        </div>
        <div class="headertop">
            <a href="index.html">
                <img src="./image/logo.png" alt="Fasser Logo" class="logo">
            </a>
            <nav>
                <div class="menu-toggle" id="mobile-menu">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </div>
                <ul class="nav-list">
                    <li><a href="index.html">Homepage</a></li>
                    <li><a href="about.html">About us</a></li>
                    <li class="dropdown">
                        <a href="products.html" class="dropbtn" id="all-products-link">Product</a>
                        <div class="dropdown-content" id="category-list">
                            <a href="products.html?category=Patch Cord" data-category="Patch Cord">Patch Cord</a>
                            <a href="products.html?category=Fiber Optic Tool" data-category="Fiber Optic Tool">Fiber Optic Tool</a>
                            <a href="products.html?category=Fiber Optic Equipment" data-category="Fiber Optic Equipment">Fiber Optic Equipment</a>
                            <a href="products.html?category=Fiber Optic Accessory" data-category="Fiber Optic Accessory">Fiber Optic Accessory</a>
                        </div>
                    </li>
                    <li><a href="contact.html">Contact us</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="carousel" style="max-width: 1200px; margin: 0 auto;">
        <div class="carousel-inner">
            <!-- Gambar carousel akan dimuat di sini -->
        </div>
        <div class="carousel-buttons">
            <button id="prev">&#10094;</button>
            <button id="next">&#10095;</button>
        </div>
    </div>
    <section class="our-services">
        <div class="content-body">
            <h2>FASSER Networks Services</h2>
            <p>Welcome to FASSER Networks. Here you will find the best products and services to meet your needs.</p>
            <div style="display: flex; align-items: center;">
                <img src="./image/accept.png" alt="accept" style="width: 25px; margin-right: 5px;"><p>FASSER Networks memberikan produk yang berkualitas dan bergaransi.</p>
            </div>
            <div style="display: flex; align-items: center;">
                <img src="./image/accept.png" alt="accept" style="width: 25px; margin-right: 5px;"><p>FASSER Networks berpengalaman dalam memberikan solusi pada kebutuhan fiber optik anda.</p>
            </div>
            <div style="display: flex; align-items: center;">
                <img src="./image/accept.png" alt="accept" style="width: 25px; margin-right: 5px;"><p>FASSER Networks memberikan peralatan fiber optik paling lengkap di Indonesia.</p>
            </div>
            
            
        </div>
        
    </section>

    <div class="blackbox">
        <div class="aboutus">
            <h3>FASSER Networks</h3>
            <p>Perusahaan kami telah berdiri sejak tahun 2022 dan bergerak di bidang Fiber Optic , Fusion Splicer , Optical Time Domain Reflectometer dan Peralatan Fiber Optic lainnya.</p>
            <img src="./image/logo.png" alt="Fasser Logo" class="logo">
        </div>
        <div class="containercustomersupportlink">
            <div class="customersupport">
                <h3>Customer Support</h3>
                <p>
                    Office :
                    <br>021-5020-2228<br>

                    <br>Whatsapp Support :
                    <br><a href="https://wa.me/6281322622658" target="_blank">0813-2262-2658</a>
                    <br><a href="https://wa.me/6282229997768" target="_blank">0822-2999-7768</a>
                    <br><a href="https://wa.me/6281280019996" target="_blank">0812-8001-9996</a><br>

                    <br>Email :
                    <br><a href="mailto:cs@alaskaputraperdana.com" target="_blank">cs@alaskaputraperdana.com</a>
                </p>
            </div>
            <div class="link">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About Us</a></li>
                    <li><a href="products.html">Products</a></li>
                    <li><a href="contact.html">Contact Us</a></li>
                </ul>
                <h3>Product Category</h3>
                <ul>
                    <li><a href="products.html?category=Patch Cord" data-category="Patch Cord">Patch Cord</a></li>
                    <li><a href="products.html?category=Fiber Optic Tool" data-category="Fiber Optic Tool">Fiber Optic Tool</a></li>
                    <li><a href="products.html?category=Fiber Optic Equipment" data-category="Fiber Optic Equipment">Fiber Optic Equipment</a></li>
                    <li><a href="products.html?category=Fiber Optic Accessory" data-category="Fiber Optic Accessory">Fiber Optic Accessory</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Tambahkan tombol Help dan form -->
    <button id="help-button">
        <img src="./image/icon-mail.png" alt="Help Icon" class="help-icon">
    </button>
    <div id="help-form" class="help-form">
        <form id="helpContactForm">
            <h3>Kontak Form</h3>
            <input type="text" id="help-name" name="name" placeholder="Nama" required>
            
            <input type="email" id="help-email" name="email" placeholder="Email" required>
            
            <input type="tel" id="help-phone" name="phone" placeholder="No Telepon" pattern="[0-9]{10,15}" required>
            
            <input type="text" id="help-company" name="company" placeholder="Nama Perusahaan" required>

            <textarea id="help-message" name="message" rows="4" placeholder="Pesan" required></textarea>
            
            <button type="submit">Kirim</button>
        </form>
    </div>

    <footer>
        <p>&copy; 2025 FASSER Networks. All rights reserved.</p>
    </footer>
</body>
<script>
    const sheetDBUrl = 'https://sheetdb.io/api/v1/2hl1pmtu3t87a';

    // Function to fetch carousel images from SheetDB
    function fetchCarouselImages() {
        fetch(`${sheetDBUrl}`)
            .then(response => response.json())
            .then(data => {
                if (data.length > 0) {
                    console.log(data);
                    displayCarouselImages(data);
                    // Save data to localStorage with timestamp
                    localStorage.setItem('carouselImages', JSON.stringify(data));
                    localStorage.setItem('carouselImagesTimestamp', new Date().getTime());
                } else {
                    console.log("No carousel images found!");
                }
            })
            .catch(error => {
                console.log("Error getting carousel images:", error);
            });
    }

    // Function to display carousel images
    function displayCarouselImages(images) {
        const carouselInner = document.querySelector('.carousel-inner');
        carouselInner.innerHTML = ''; // Clear existing images

        images.forEach((image, index) => {
            const imgElement = document.createElement('img');
            let imgSrc = image.gambar;

            console.log(`Original image URL: ${imgSrc}`); // Log original URL

            // Check if the URL is a Google Drive share link and convert it to a direct link
            if (imgSrc.includes('drive.google.com/file/d/')) {
                const driveId = imgSrc.split('/d/')[1].split('/')[0]; // Extract the file ID
                imgSrc = `https://drive.google.com/uc?export=view&id=${driveId}`; // Convert to direct link
            }

            console.log(`Converted image URL: ${imgSrc}`); // Log converted URL

            imgElement.src = imgSrc;
            imgElement.alt = `Carousel Image ${index + 1}`;
            imgElement.onerror = function() {
                console.log(`Error loading image: ${imgSrc}`);
            };
            carouselInner.appendChild(imgElement);
        });

        // Reinitialize carousel functionality
        initializeCarousel();
    }

    // Function to initialize carousel functionality
    function initializeCarousel() {
        const carousel = document.querySelector('.carousel-inner');
        const images = document.querySelectorAll('.carousel-inner img');
        const totalImages = images.length;
        let index = 0;

        document.getElementById('prev').addEventListener('click', () => {
            index = (index > 0) ? index - 1 : totalImages - 1;
            carousel.style.transform = `translateX(-${index * 100}%)`;
        });

        document.getElementById('next').addEventListener('click', () => {
            index = (index < totalImages - 1) ? index + 1 : 0;
            carousel.style.transform = `translateX(-${index * 100}%)`;
        });

        let currentIndex = 0;
        const totalSlides = images.length;

        function showSlide(index) {
            carousel.style.transform = `translateX(-${index * 100}%)`;
        }

        function nextSlide() {
            currentIndex = (currentIndex + 1) % totalSlides;
            showSlide(currentIndex);
        }

        // Auto-slide every 5 seconds
        setInterval(nextSlide, 5000);
    }

    // Fetch carousel images on page load
    document.addEventListener('DOMContentLoaded', function() {
        const cachedData = localStorage.getItem('carouselImages');
        const cachedTimestamp = localStorage.getItem('carouselImagesTimestamp');
        const now = new Date().getTime();
        const cacheDuration = 1 * 60 * 60 * 1000; // 1 hour in milliseconds

        if (cachedData && cachedTimestamp && (now - cachedTimestamp < cacheDuration)) {
            const data = JSON.parse(cachedData);
            console.log('Using cached data:', data);
            displayCarouselImages(data);
        } else {
            fetchCarouselImages();
        }
    });

    // JavaScript untuk tombol Help dan form
    const helpButton = document.getElementById('help-button');
    const helpForm = document.getElementById('help-form');

    helpButton.addEventListener('click', function() {
        helpForm.classList.toggle('active');
    });

    document.getElementById('helpContactForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Mencegah form submit default
        sendFormData('helpContactForm', 'help-name', 'help-email', 'help-phone', 'help-company', 'help-message');
    });
</script>
</html>
